(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{X2qB:function(c,t,e){"use strict";e.r(t),e.d(t,"MainModule",(function(){return W}));var n=e("ofXK"),i=e("tyNb"),o=e("jtHE"),s=e("2Vo4"),r=e("fXoL"),b=e("q6HN"),l=e("AytR"),a=e("gFX4"),u=e("hrsj"),p=e("tk/3");let d=(()=>{class c{constructor(c,t,e){this.tokenService=c,this.adminService=t,this.http=e,this.socket=null,this.socketObservable=new s.a(null),this.adminService.getAdmin().subscribe(t=>{console.log("admin for socket",t,c.token),t&&(this.socket=a.connect(`${l.a.backURL}`,{query:{token:c.token,worldName:"world1"}}),this.socketObservable.next(this.socket))})}}return c.\u0275fac=function(t){return new(t||c)(r.Wb(u.a),r.Wb(b.a),r.Wb(p.b))},c.\u0275prov=r.Ib({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();var f=e("5RKK");let v=(()=>{class c{transform(c,...t){return"key"===c||"x"===c||"y"===c||"key_"===c||"id"===c?null:c}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275pipe=r.Lb({name:"keyFree",type:c,pure:!0}),c})();const h=["viewver"];function m(c,t){if(1&c){const c=r.Tb();r.Sb(0,"button",2),r.ac("click",(function(){r.pc(c);const e=t.$implicit;return r.cc(2).selectWorld(e)})),r.xc(1),r.Rb()}if(2&c){const c=t.$implicit;r.Cb(1),r.zc(" ",c.name," ")}}function w(c,t){if(1&c&&(r.Sb(0,"div"),r.vc(1,m,2,1,"button",1),r.Rb()),2&c){const c=t.$implicit;r.Cb(1),r.ic("ngForOf",c)}}function g(c,t){if(1&c&&(r.Sb(0,"div"),r.Nb(1,"br"),r.Sb(2,"p"),r.xc(3),r.Rb(),r.Sb(4,"p"),r.xc(5),r.Rb(),r.Sb(6,"p"),r.xc(7),r.Rb(),r.Rb()),2&c){const c=t.$implicit;r.Cb(3),r.zc("key: ",c.key_,""),r.Cb(2),r.zc("color : ",c.color,""),r.Cb(2),r.zc("img : ",c.img,"")}}function k(c,t){if(1&c){const c=r.Tb();r.Sb(0,"div"),r.Nb(1,"input",9,10),r.Sb(3,"button",2),r.ac("click",(function(){r.pc(c);const t=r.nc(2),e=r.cc().$implicit,n=r.cc().$implicit;return r.cc(3).sendUpdate(n,e.key,t.value)})),r.xc(4,"send update"),r.Rb(),r.Rb()}if(2&c){const c=r.cc().$implicit;r.Cb(1),r.ic("value",c.value)}}function S(c,t){if(1&c&&r.xc(0),2&c){const c=r.cc().$implicit;r.zc(" ",c.value,"")}}function y(c,t){if(1&c&&(r.Sb(0,"div"),r.Sb(1,"p"),r.xc(2),r.Rb(),r.vc(3,k,5,1,"div",7),r.dc(4,"keyFree"),r.vc(5,S,1,1,"ng-template",null,8,r.wc),r.Nb(7,"br"),r.Rb()),2&c){const c=t.$implicit,e=r.nc(6);r.Cb(2),r.zc("",c.key,":"),r.Cb(1),r.ic("ngIf",r.ec(4,3,c.key))("ngIfElse",e)}}function x(c,t){if(1&c&&(r.Sb(0,"div"),r.Sb(1,"h3"),r.xc(2),r.Rb(),r.vc(3,y,8,5,"div",3),r.dc(4,"keyvalue"),r.Rb()),2&c){const c=t.$implicit;r.Cb(2),r.zc("name: ",c.name,""),r.Cb(1),r.ic("ngForOf",r.ec(4,2,c))}}function R(c,t){if(1&c&&(r.Sb(0,"div"),r.xc(1," test "),r.vc(2,x,5,4,"div",3),r.Rb()),2&c){const c=t.$implicit;r.Cb(2),r.ic("ngForOf",c)}}function C(c,t){if(1&c){const c=r.Tb();r.Sb(0,"div"),r.Sb(1,"h3"),r.xc(2),r.Rb(),r.Sb(3,"p"),r.xc(4),r.Rb(),r.Sb(5,"p"),r.xc(6),r.Rb(),r.Sb(7,"p"),r.xc(8),r.dc(9,"json"),r.Rb(),r.Nb(10,"br"),r.Sb(11,"h3"),r.xc(12,"clans:"),r.Rb(),r.vc(13,g,8,3,"div",3),r.Nb(14,"br"),r.Sb(15,"div",4),r.Sb(16,"app-world-viewver",5,6),r.ac("moveRequest",(function(t){return r.pc(c),r.cc().move(t)}))("focusCase",(function(t){return r.pc(c),r.cc().focus(t)})),r.Rb(),r.Rb(),r.vc(18,R,3,1,"div",0),r.dc(19,"async"),r.Rb()}if(2&c){const c=t.$implicit,e=r.cc();r.Cb(2),r.yc(c.name),r.Cb(2),r.zc("width:",c.width,""),r.Cb(2),r.zc("height:",c.height,""),r.Cb(2),r.yc(r.ec(9,8,c)),r.Cb(5),r.ic("ngForOf",c.clans),r.Cb(3),r.ic("socket",e.socketService.socketObservable)("character",e.chara),r.Cb(2),r.ic("ngIf",r.ec(19,10,e.focusedCase))}}let O=(()=>{class c{constructor(c,t){this.adminService=c,this.socketService=t,this.worlds=new o.a,this.world=new s.a(null),this.chara=new s.a({position:{x:0,y:0}}),this.focusedCase=new s.a(null)}ngOnInit(){this.worlds.subscribe(c=>{this.worldsActual=c}),this.adminService.getWorlds().subscribe(c=>{this.worlds.next(c),this.world.next(c[0]),this.chara.next({position:{x:0,y:0}}),console.log("admin worlds",c)})}move(c){console.log("move",c);let t=this.chara.getValue();t.position.x+=c.x,t.position.y+=c.y,this.chara.next(t)}focus(c){console.log("focusing",c),this.focusedCase.next(c)}selectWorld(c){for(let t of this.worldsActual)if(t.name===c){this.world.next(t);break}}sendUpdate(c,t,e){console.log("send update",this.world.getValue(),c,t,e),this.adminService.updateWorldValue(this.world.getValue().name,c,t,e,c=>{console.log(this.viewver),console.log("res update",c),c&&this.viewver.updateObjs([c],c=>{})})}}return c.\u0275fac=function(t){return new(t||c)(r.Mb(b.a),r.Mb(d))},c.\u0275cmp=r.Gb({type:c,selectors:[["app-admin-world"]],viewQuery:function(c,t){var e;1&c&&r.Cc(h,!0),2&c&&r.mc(e=r.bc())&&(t.viewver=e.first)},decls:7,vars:6,consts:[[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[4,"ngFor","ngForOf"],[1,"map"],[3,"socket","character","moveRequest","focusCase"],["viewver",""],[4,"ngIf","ngIfElse"],["justShow",""],[3,"value"],["input",""]],template:function(c,t){1&c&&(r.Sb(0,"h2"),r.xc(1,"Admin Worlds"),r.Rb(),r.vc(2,w,2,1,"div",0),r.dc(3,"async"),r.vc(4,C,20,12,"div",0),r.dc(5,"async"),r.Nb(6,"router-outlet")),2&c&&(r.Cb(2),r.ic("ngIf",r.ec(3,2,t.worlds)),r.Cb(2),r.ic("ngIf",r.ec(5,4,t.world)))},directives:[n.n,i.e,n.m,f.a],pipes:[n.b,n.g,n.h,v],styles:[".map[_ngcontent-%COMP%]{width:512px;height:256px}"]}),c})(),I=(()=>{class c{constructor(){}ngOnInit(){}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=r.Gb({type:c,selectors:[["app-calculs"]],decls:2,vars:0,template:function(c,t){1&c&&(r.Sb(0,"p"),r.xc(1,"calculs works!"),r.Rb())},styles:[""]}),c})();function $(c,t){1&c&&(r.Sb(0,"div"),r.xc(1," test\n"),r.Rb())}let F=(()=>{class c{constructor(c){this.adminService=c,this.test=new s.a("bonjour")}ngOnInit(){}logOut(){this.adminService.logOut()}}return c.\u0275fac=function(t){return new(t||c)(r.Mb(b.a))},c.\u0275cmp=r.Gb({type:c,selectors:[["app-main"]],decls:13,vars:7,consts:[[3,"click"],[3,"routerLink"],[4,"ngIf"]],template:function(c,t){1&c&&(r.Sb(0,"button",0),r.ac("click",(function(){return t.logOut()})),r.xc(1,"logout"),r.Rb(),r.Sb(2,"button",1),r.xc(3,"users"),r.Rb(),r.Sb(4,"button",1),r.xc(5,"worlds"),r.Rb(),r.Sb(6,"button",1),r.xc(7,"patterns"),r.Rb(),r.Sb(8,"button",1),r.xc(9,"calculs"),r.Rb(),r.vc(10,$,2,0,"div",2),r.dc(11,"async"),r.Nb(12,"router-outlet")),2&c&&(r.Cb(2),r.ic("routerLink","users"),r.Cb(2),r.ic("routerLink","worlds"),r.Cb(2),r.ic("routerLink","patterns"),r.Cb(2),r.ic("routerLink","calculs"),r.Cb(2),r.ic("ngIf",r.ec(11,5,t.test)))},directives:[i.c,n.n,i.e],pipes:[n.b],styles:[""]}),c})(),z=(()=>{class c{constructor(){}ngOnInit(){}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=r.Gb({type:c,selectors:[["app-patterns"]],decls:2,vars:0,template:function(c,t){1&c&&(r.Sb(0,"p"),r.xc(1,"patterns works!"),r.Rb())},styles:[""]}),c})();const N=i.d.forChild([{path:"",component:F,children:[{path:"users",component:(()=>{class c{constructor(){}ngOnInit(){}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=r.Gb({type:c,selectors:[["app-users"]],decls:2,vars:0,template:function(c,t){1&c&&(r.Sb(0,"p"),r.xc(1,"users works!"),r.Rb())},styles:[""]}),c})()},{path:"patterns",component:z},{path:"calculs",component:I},{path:"worlds",component:O}]}]);var j=e("ze14");let L=(()=>{class c{}return c.\u0275mod=r.Kb({type:c}),c.\u0275inj=r.Jb({factory:function(t){return new(t||c)},imports:[[n.c]]}),c})(),W=(()=>{class c{}return c.\u0275mod=r.Kb({type:c}),c.\u0275inj=r.Jb({factory:function(t){return new(t||c)},imports:[[n.c,N,j.a,L]]}),c})()}}]);